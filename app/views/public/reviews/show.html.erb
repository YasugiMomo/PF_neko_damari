<div class="container">
  <div class="row">

    <div class="col-8 card mb-3">
      <div class="row g-0">
        <div class="col-md-4">
          <%= image_tag @shop.get_shop_image(100,100) %>
        </div>
        <div class="col-md-8">
          <div class="card-body">
            <h5 class="card-title"><%= @shop.name %></h5>
            <p class="card-text"><%= @shop.address %></p>
            <div class="card-content average-score">
                <div class="average-review-rating" data-score=<%= @shop.avg_rate %>></div>
                <%= render 'public/shops/average' %>
                <div class="average-score-display">
                  <%= @shop.avg_rate %>点(<%= link_to @shop.reviews.count, shop_review_path(@shop) %>件のレビュー)
                </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
</div>




  <div class="review-details-section">
    <p>レビュー詳細</p>

    <p>評価：<%= @review.rate %>点 </p>
    <div id="star-rate-<%= @review.id %>",  class="mb-2"></div>
    <script>
          $('#star-rate-<%= @review.id %>').raty({
            size: 36,
            starOff:  '<%= asset_path('star-off.png') %>',
            starOn : '<%= asset_path('star-on.png') %>',
            starHalf: '<%= asset_path('star-half.png') %>',
            half: true,
            readOnly: true,
            score: <%= @review.rate %>,
        });
    </script>
    <div class="review-section">
      <div>
        タイトル：
        <%= @review.title %>
      </div>
      <div>
        レビュー:
        <%= @review.content %>
      </div>
      <!--レビューの投稿画像を表示-->
      <div>
        <p>投稿写真：</p><br>
        <% @review.review_images.each do |image| %>
          <%= image_tag(image, width:100) %>
        <% end %>
      </div>
      <div>
        <% @review_tags.each do |tag| %>
          <%= link_to tag.tag_name, tag_reviews_path(tag_id: tag.id) %>
          <%= "(#{tag.reviews.count})" %>
        <% end %>
      </div>
    </div>

    <div class="action">
      <% if @review.customer == current_customer %>
        <%= link_to "編集する", edit_shop_review_path(@review), class: "btn btn-success" %>
        <%= link_to "削除する", shop_review_path(@review), class: "btn btn-danger", method: :delete, data: {confirm: "削除しますか？"}  %>
      <% end %>
    </div>

  </div>

  <div class="comment-index-section">
    <p>コメント一覧</p>
    <% @comments.each do |comment| %>
    <div class="comment-list">
      <%= comment.customer.nickname %>
      <%= comment.comment %>
      <% if comment.customer == current_customer %>
        <%= link_to "削除する", comment_path(comment), class: "btn btn-danger", method: :delete, data: {confirm: "削除しますか？"}  %>
      <% end %>
    </div>
    <% end %>
  </div>

  <div class="comment-section">
    <!--コメント投稿フォーム-->
    <%= form_with model: [@shop, @review, @comment] do |f| %>

      <%= f.label "コメント：" %><br>
      <%= f.text_area :comment %><br>

      <%= f.submit "コメントする" %>

    <% end %>
  </div>




